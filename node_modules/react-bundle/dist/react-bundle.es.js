import { Component } from 'react';
import isPromise from 'ispromise';

var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();









var inherits = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
};











var possibleConstructorReturn = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && (typeof call === "object" || typeof call === "function") ? call : self;
};

var Bundle = function (_Component) {
  inherits(Bundle, _Component);

  function Bundle() {
    classCallCheck(this, Bundle);

    var _this = possibleConstructorReturn(this, (Bundle.__proto__ || Object.getPrototypeOf(Bundle)).call(this));

    _this.state = {
      mod: null
    };


    _this.__mounted = false;
    return _this;
  }

  createClass(Bundle, [{
    key: 'componentWillMount',
    value: function componentWillMount() {
      this.__mounted = true;
      this.load(this.props);
    }
  }, {
    key: 'componentWillUnmount',
    value: function componentWillUnmount() {
      this.__mounted = false;
    }
  }, {
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      if (nextProps.load !== this.props.load) {
        this.load(nextProps);
      }
    }
  }, {
    key: 'load',
    value: function load(_ref) {
      var _this2 = this;

      var _load = _ref.load;

      if (!this.__mounted) {
        return;
      }

      this.setState({
        mod: null
      });

      var loaded = function loaded(mod) {
        if (!_this2.__mounted) {
          return;
        }

        _this2.setState({ mod: mod.default ? mod.default : mod });
      };

      var res = _load(loaded);

      if (isPromise(res)) {
        res.then(loaded);
      }
    }
  }, {
    key: 'render',
    value: function render() {
      return this.props.children(this.state.mod);
    }
  }]);
  return Bundle;
}(Component);

export default Bundle;

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBpc1Byb21pc2UgZnJvbSAnaXNwcm9taXNlJztcblxuY2xhc3MgQnVuZGxlIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGUgPSB7XG4gICAgbW9kOiBudWxsXG4gIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuX19tb3VudGVkID0gZmFsc2U7XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5fX21vdW50ZWQgPSB0cnVlO1xuICAgIHRoaXMubG9hZCh0aGlzLnByb3BzKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMuX19tb3VudGVkID0gZmFsc2U7XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMubG9hZCAhPT0gdGhpcy5wcm9wcy5sb2FkKSB7XG4gICAgICB0aGlzLmxvYWQobmV4dFByb3BzKTtcbiAgICB9XG4gIH1cblxuICBsb2FkKHsgbG9hZCB9KSB7XG4gICAgaWYgKCF0aGlzLl9fbW91bnRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgbW9kOiBudWxsXG4gICAgfSk7XG5cbiAgICBjb25zdCBsb2FkZWQgPSBtb2QgPT4ge1xuICAgICAgaWYgKCF0aGlzLl9fbW91bnRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBtb2Q6IG1vZC5kZWZhdWx0ID8gbW9kLmRlZmF1bHQgOiBtb2QgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IHJlcyA9IGxvYWQobG9hZGVkKTtcblxuICAgIGlmIChpc1Byb21pc2UocmVzKSkge1xuICAgICAgcmVzLnRoZW4obG9hZGVkKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW4odGhpcy5zdGF0ZS5tb2QpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJ1bmRsZTtcbiJdLCJuYW1lcyI6WyJCdW5kbGUiLCJzdGF0ZSIsIl9fbW91bnRlZCIsImxvYWQiLCJwcm9wcyIsIm5leHRQcm9wcyIsInNldFN0YXRlIiwibG9hZGVkIiwibW9kIiwiZGVmYXVsdCIsInJlcyIsImlzUHJvbWlzZSIsInRoZW4iLCJjaGlsZHJlbiIsIkNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBR01BOzs7b0JBS1U7Ozs7O1VBSmRDLEtBSWMsR0FKTjtXQUNEO0tBR087OztVQUdQQyxTQUFMLEdBQWlCLEtBQWpCOzs7Ozs7eUNBR21CO1dBQ2RBLFNBQUwsR0FBaUIsSUFBakI7V0FDS0MsSUFBTCxDQUFVLEtBQUtDLEtBQWY7Ozs7MkNBR3FCO1dBQ2hCRixTQUFMLEdBQWlCLEtBQWpCOzs7OzhDQUd3QkcsV0FBVztVQUMvQkEsVUFBVUYsSUFBVixLQUFtQixLQUFLQyxLQUFMLENBQVdELElBQWxDLEVBQXdDO2FBQ2pDQSxJQUFMLENBQVVFLFNBQVY7Ozs7OytCQUlXOzs7VUFBUkYsS0FBUSxRQUFSQSxJQUFROztVQUNULENBQUMsS0FBS0QsU0FBVixFQUFxQjs7OztXQUloQkksUUFBTCxDQUFjO2FBQ1A7T0FEUDs7VUFJTUMsU0FBUyxTQUFUQSxNQUFTLE1BQU87WUFDaEIsQ0FBQyxPQUFLTCxTQUFWLEVBQXFCOzs7O2VBSWhCSSxRQUFMLENBQWMsRUFBRUUsS0FBS0EsSUFBSUMsT0FBSixHQUFjRCxJQUFJQyxPQUFsQixHQUE0QkQsR0FBbkMsRUFBZDtPQUxGOztVQVFNRSxNQUFNUCxNQUFLSSxNQUFMLENBQVo7O1VBRUlJLFVBQVVELEdBQVYsQ0FBSixFQUFvQjtZQUNkRSxJQUFKLENBQVNMLE1BQVQ7Ozs7OzZCQUlLO2FBQ0EsS0FBS0gsS0FBTCxDQUFXUyxRQUFYLENBQW9CLEtBQUtaLEtBQUwsQ0FBV08sR0FBL0IsQ0FBUDs7OztFQW5EaUJNOzs7OyJ9